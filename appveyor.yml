version: '{build}'

env:
  global:
    - PYTEST="bin/py.test -n 2 -vvs --cov=src --cov-report=term --cov-report=xml"
  matrix:
    - TEST_SUITE="$PYTEST --ignore=tests/scancode --ignore=tests/extractcode --ignore=tests/licensedcode --ignore=tests/cluecode --ignore=tests/packagedcode"
    - TEST_SUITE="$PYTEST tests/scancode"
    - TEST_SUITE="$PYTEST tests/extractcode"
    - TEST_SUITE="$PYTEST tests/licensedcode --ignore=tests/licensedcode/test_zzzz_cache.py --ignore=tests/licensedcode/test_detection_datadriven_more.py --ignore=tests/licensedcode/test_detection_datadriven.py"
    - TEST_SUITE="$PYTEST tests/licensedcode/test_detection_datadriven.py"
    - TEST_SUITE="$PYTEST tests/licensedcode/test_detection_datadriven_more.py"
    - TEST_SUITE="$PYTEST tests/licensedcode/test_zzzz_cache.py"
    - TEST_SUITE="$PYTEST tests/cluecode"
    - TEST_SUITE="$PYTEST tests/packagedcode"
    - TEST_SUITE="./etc/release/release.sh"
install:
    - configure

build: off


test_script:
    - python -c "import sys;print sys.getdefaultencoding()"
    - cmd: "%TEST_SUITE%"

on_failure:
    - "python etc/scripts/irc-notify.py aboutcode [{project_name}:{branch}] {short_commit}: \"{message}\" ({author}) {color_red}Failed - {build_url}"
