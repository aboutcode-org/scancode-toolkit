This differs from Colin Plumb's older public domain implementation