Parts of this driver are based on the GPL driver