ported from the linux driver written by
This software may be used and distributed according to the terms
of the GNU Public License, incorporated herein by reference.
